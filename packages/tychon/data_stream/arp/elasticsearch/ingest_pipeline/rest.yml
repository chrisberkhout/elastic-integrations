---
description: Pipeline for TYCHON ARP Tables
processors:

  - uppercase:
      field: tychon.destination.mac

  # ECS fields

  - set:
      field: event.category
      value: [network]

  # ECS fields from the tychon fieldset

  - append:
      field: related.hosts
      value: "{{tychon.destination.hostname}}"
      if: ctx.tychon?.destination?.hostname != null && ctx.tychon.destination.hostname != ""
      allow_duplicates: false
  - append:
      field: related.ip
      value: "{{tychon.destination.ip}}"
      if: ctx.tychon?.destination?.ip != null && ctx.tychon.destination.ip != ""
      allow_duplicates: false

  - set:
      field: destination.ip
      copy_from: tychon.destination.ip
      ignore_empty_value: true
  - set:
      field: destination.mac
      copy_from: tychon.destination.mac
      ignore_empty_value: true
  - set:
      field: network.direction
      copy_from: tychon.network.direction
      ignore_empty_value: true
  - set:
      field: network.type
      copy_from: tychon.network.type
      ignore_empty_value: true
