---
description: Pipeline for Exposed Services
processors:

  - convert:
      field: tychon.process.pid
      type: long
      ignore_missing: true
  - convert:
      field: tychon.source.port
      type: long
      ignore_missing: true
  - set:
      field: tychon.source.ip
      value: '0.0.0.0'
      if: ctx.tychon.source?.ip == ''
  - set:
      field: tychon.service.name
      value: '{{tychon.process.name}}'
      if: "ctx.tychon.service?.name == null"

  # ECS fields

  - set:
      field: event.category
      value: [network]