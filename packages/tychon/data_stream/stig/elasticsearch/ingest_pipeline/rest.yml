---
description: Pipeline for TYCHON STIG Response Data
processors:

  - set:
      if: "ctx.tychon?.rule?.test_result != null"
      field: tychon.rule.result
      value: '{{tychon.rule.test_result}}'
  - remove:
      field: tychon.rule.test_result
      ignore_missing: true
  - convert:
      field: tychon.rule.weight
      type: float
      ignore_missing: true

  # ECS fields

  - set:
      field: event.category
      value: [vulnerability, configuration]

  # ECS fields from the tychon fieldset

  - set:
      field: rule.id
      copy_from: tychon.rule.id
      ignore_empty_value: true
  - set:
      field: rule.name
      copy_from: tychon.rule.name
      ignore_empty_value: true
